---
import EntryLayout from '../layouts/EntryLayout.astro';
import { getCollection } from 'astro:content';

// Get slug from URL params (SSR mode)
const { slug } = Astro.params;

// Fetch all entries and find the matching one
const entries = await getCollection('journal', ({ data }) => !data.draft);
const entry = entries.find(e => e.slug === slug);

// 404 if entry not found
if (!entry) {
  return Astro.redirect('/404');
}
---

<EntryLayout entry={entry} />
